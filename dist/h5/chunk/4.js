(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"133":function(e,t,a){},"134":function(e,t,a){},"135":function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return h}));var c=a(18),r=a.n(c),s=a(23),n=a(20),i=a(131),o=a(2),l=(a(133),a(46)),u=function Carousel(e){var t=e.pictureArray,a=e.videoArray,c=e.sid,u=document.body.offsetHeight,d=document.body.offsetWidth,j=Object(o.useState)(0),m=Object(n.a)(j,2),p=m[0],b=m[1];return Object(o.useEffect)((function(){console.log("carousel mount");var e=function(){var e=Object(s.a)(r.a.mark((function _callee(e){var t;return r.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.length){a.next=2;break}return a.abrupt("return");case 2:(t=new Image).src=e[0],t.onload=function(e){var t=e.currentTarget,a=t.width,c=t.height;b(c/a)};case 5:case"end":return a.stop()}}),_callee)})));return function getFirstPictureSize(t){return e.apply(this,arguments)}}();0!==t.length&&e(t)}),[t,p,d]),Object(l.jsxs)(i.l,{"className":"swiper","indicatorColor":"#999","indicatorActiveColor":"#333","vertical":!1,"circular":!1,"indicatorDots":!0,"autoplay":!1,"children":[a.map((function(e){return Object(l.jsx)(i.m,{"className":"swiperItemVideo","style":{"height":"".concat(u,"px")},"children":Object(l.jsx)(i.q,{"id":"mse-"+c,"className":"vodContainer"})},e)})),t.map((function(e){return Object(l.jsx)(i.m,{"className":"swiperItemPicture","style":{"height":0===p?"60vh":"".concat(p*d,"px")},"children":Object(l.jsx)(i.c,{"mode":"aspectFit","className":"img","src":e})},e)}))]})},d=a(47),j=a(49),m=a(21),p=a(132),b=a(48),h=(a(134),function StoryBlock(e){var t=e.id,a=(e.uid,e.title),c=e.username,r=(e.viewedTimes,e.coverImgUrl),s=Object(j.b)();return Object(l.jsxs)(i.q,{"className":"storyContainer","onClick":function enterStory(){var e=Object(m.b)();console.log(e);var a,c=[],r=Object(d.a)(e);try{for(r.s();!(a=r.n()).done;){var n=a.value;void 0!==n.$taroParams.sid&&c.push(n.$taroParams.sid)}}catch(e){r.e(e)}finally{r.f()}s(Object(b.b)({"stack":c})),Object(m.e)({"url":"/pages/detailPage/detailPage?sid=".concat(t)})},"children":[Object(l.jsxs)(i.q,{"className":"storyinfo","children":[Object(l.jsx)(i.q,{"className":"storyimage","children":Object(l.jsx)(i.c,{"mode":"widthFix","className":"image","src":r})}),Object(l.jsx)(i.o,{"className":"title","children":a})]}),Object(l.jsxs)(i.q,{"className":"storyappend","children":[Object(l.jsxs)(i.q,{"className":"user","children":[Object(l.jsx)(i.q,{"className":"userImageWrapper","children":Object(l.jsx)(i.q,{"className":"avatar-container","children":Object(l.jsx)(p.a,{"className":"avatar","size":"small","circle":!0,"text":c[0].toUpperCase()})})}),Object(l.jsx)(i.o,{"className":"name","children":c})]}),Object(l.jsx)(i.q,{"className":"like","children":Object(l.jsx)(i.c,{"className":"heart","src":""})})]})]})})},"157":function(e,t,a){},"164":function(e,t,a){"use strict";a.r(t),a.d(t,"DetailPage",(function(){return g}));var c=a(47),r=a(18),s=a.n(r),n=a(23),i=a(20),o=a(2),l=a(129),u=a(25),d=a(169),j=a(136),m=a(155),p=a.n(m),b=a(156),h=a.n(b),O=a(132),x=a(131),f=(a(157),a(135)),y=a(46),g=function DetailPage(){document.body.offsetHeight;var e=Object(l.b)(),t=u.a.useRouter(),a=Object(o.useState)(null),r=Object(i.a)(a,2),m=r[0],b=r[1];Object(o.useEffect)((function(){return console.log("MOUNT"),null!==m&&console.log(m),function(){return console.log("UNMOUNT")}}),[]);var g=Object(o.useState)(""),v=Object(i.a)(g,2),N=v[0],w=v[1],q=Object(o.useState)(""),A=Object(i.a)(q,2),S=A[0],U=A[1],_=Object(o.useState)([]),C=Object(i.a)(_,2),T=C[0],I=C[1],D=Object(o.useState)(" "),E=Object(i.a)(D,2),P=E[0],k=E[1],M=Object(o.useState)([]),V=Object(i.a)(M,2),z=V[0],F=V[1],L=Object(o.useState)([]),R=Object(i.a)(L,2),$=(R[0],R[1]),G=Object(o.useState)(),H=Object(i.a)(G,2),B=H[0],J=H[1],W=function(){var e=Object(n.a)(s.a.mark((function _callee(e,t,a,c){return s.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:Object(d.a)({"url":"https://api.yuandan.ac-code.com/weixin_jsapi_signature","method":"GET","header":{"noncestr":"RANDOMACCESSMEMORIES","timestamp":1646967249,"url":window.location.href.split("#")[0]}}).then((function(r){console.log(r);var s=r.data.signature;j.a.config({"debug":!1,"appId":"wx5ae7808267e29706","timestamp":1646967249,"nonceStr":"RANDOMACCESSMEMORIES","signature":s,"jsApiList":["updateAppMessageShareData","updateTimelineShareData"],"openTagList":[]}),j.a.ready((function(){console.log("wx ready"),j.a.updateAppMessageShareData({"title":e,"desc":t,"link":"http://m.yuandan.ac-code.com/#/pages/detailPage/detailPage?sid=".concat(a),"imgUrl":c,"success":function success(){throw new Error("Function not implemented.")},"cancel":function cancel(){throw new Error("Function not implemented.")}})}))})).catch((function(e){console.log(e)}));case 1:case"end":return r.stop()}}),_callee)})));return function getWeixinJsApiSignature(t,a,c,r){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){function _getStoryData(){return(_getStoryData=Object(n.a)(s.a.mark((function _callee2(){var a,c,r,n,i,o,l;return s.a.wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return c=null===(a=e.router)||void 0===a?void 0:a.params.sid,s.next=3,Object(d.a)({"url":"https://api.yuandan.ac-code.com/story/"+c,"method":"GET","success":function success(e){w(e.data.storyTitle),document.title=e.data.storyTitle+"  - 元弹",U(e.data.storyContent),I(e.data.pictureUrlArray),k(e.data.username),F(e.data.videoArray),$(e.data.posterUriArray),J(e.data.sid);var t="";0!==e.data.pictureUrlArray.length&&(t=e.data.pictureUrlArray[0]),0!==e.data.posterUriArray.length&&(t="https://poster.yuandanapi.ac-code.com/"+e.data.posterUriArray[0]+"~tplv-vod-noop.image"),W(e.data.storyTitle,e.data.storyContent,e.data.sid,t)}});case 3:if(0===(r=s.sent).data.videoArray.length){s.next=7;break}return s.next=7,Object(d.a)({"url":"https://api.yuandan.ac-code.com/playAuth?vid="+r.data.videoArray[0],"method":"GET","success":function success(e){var t=e.data;p.a.url(t,"//vod.volcengineapi.com").then((function(e){console.log("initialize player",e);var t=new h.a({"id":"mse-"+r.data.sid,"url":e.PlayInfoList[0].MainPlayUrl,"height":"auto","autoplay":!0,"videoInit":!0});b(t)}))}});case 7:n=window,i=n.aplus_queue,o={"is_auto":!1},l={"url":t.path},i.push({"action":"aplus.sendPV","arguments":[o,l]});case 8:case"end":return s.stop()}}),_callee2)})))).apply(this,arguments)}!function getStoryData(){return _getStoryData.apply(this,arguments)}()}),[]);var K={"pictureUrlArray":[],"storyTitle":"xxx","storyContent":"xxx","username":"xxx","walletAddress":"xxx","sid":"xxx","videoArray":[],"posterUriArray":[],"coverImgUrl":""},Q=Object(o.useState)([K]),X=Object(i.a)(Q,2),Y=X[0],Z=X[1],ee=Object(o.useState)([K]),te=Object(i.a)(ee,2),ae=te[0],ce=te[1];Object(o.useEffect)((function(){Object(d.a)({"url":"https://api.yuandan.ac-code.com/explore/","method":"GET","success":function success(e){console.log(e);var t,a=e.data,r=Object(c.a)(a);try{for(r.s();!(t=r.n()).done;){var s=t.value;0!==s.pictureUrlArray.length?s.coverImgUrl=s.pictureUrlArray[0]:0!=s.posterUriArray.length&&(s.coverImgUrl="https://poster.yuandanapi.ac-code.com/"+s.posterUriArray[0]+"~tplv-vod-noop.image")}}catch(e){r.e(e)}finally{r.f()}var n=a.filter((function(e,t){if(t%2==1)return e}));Z(n);var i=a.filter((function(e,t){if(t%2==0)return e}));ce(i)}})}),[]),u.a.useDidHide((function(){console.log("componentDidHide"),console.log(m),null!==m&&m.pause()}));var re=Object(y.jsxs)(x.q,{"className":"author-bar","children":[Object(y.jsx)(x.q,{"className":"avatar-container","children":Object(y.jsx)(O.a,{"className":"avatar","size":"small","circle":!0,"text":P[0].toUpperCase()})}),Object(y.jsx)(x.q,{"className":"username","children":Object(y.jsx)(x.o,{"children":P})}),Object(y.jsx)(x.q,{"className":"followButton","children":Object(y.jsx)(O.b,{"size":"small","circle":!0,"children":"关注"})})]}),se=Object(y.jsxs)(x.q,{"className":"author-barV","children":[Object(y.jsx)(x.q,{"className":"avatar-containerV","children":Object(y.jsx)(O.a,{"className":"avatarV","size":"small","circle":!0,"text":P[0].toUpperCase()})}),Object(y.jsx)(x.q,{"className":"usernameV","children":Object(y.jsx)(x.o,{"children":P})})]}),ne=Object(y.jsx)(x.q,{"className":"story","children":Object(y.jsxs)(x.q,{"className":"storyarea","children":[Object(y.jsx)(x.q,{"className":"storytitle","children":Object(y.jsx)(x.q,{"className":"at-article__h2","children":N})}),Object(y.jsx)(x.q,{"className":"storymain","children":S.split("\n").map((function(e){return Object(y.jsx)(x.q,{"className":"at-article__p","children":e},e)}))})]})}),ie=Object(y.jsx)(x.q,{"className":"storyV","children":Object(y.jsx)(x.q,{"className":"storyareaV","children":Object(y.jsx)(x.q,{"className":"storymainV","children":S.split("\n").map((function(e){return Object(y.jsx)(x.q,{"className":"at-article__p","children":e},e)}))})})}),oe=Object(y.jsx)(O.c,{"className":"recommendDivider","content":"相关推荐"}),le=Object(y.jsx)(O.c,{"className":"recommendDividerV","content":"相关推荐"}),ue=Object(y.jsxs)(x.q,{"className":"recommendBox","children":[Object(y.jsx)(x.q,{"className":"column","children":Object(y.jsx)(x.q,{"className":"storyListContainer","children":Y.map((function(e){return Object(y.jsx)(f.b,{"id":e.sid,"uid":e.walletAddress,"title":e.storyTitle,"username":e.username,"viewedTimes":100,"coverImgUrl":e.coverImgUrl},e.sid)}))})}),Object(y.jsx)(x.q,{"className":"column","children":Object(y.jsx)(x.q,{"className":"storyListContainer","children":ae.map((function(e){return Object(y.jsx)(f.b,{"id":e.sid,"uid":e.walletAddress,"title":e.storyTitle,"username":e.username,"viewedTimes":100,"coverImgUrl":e.coverImgUrl},e.sid)}))})})]});return Object(y.jsxs)(x.q,{"className":"detailPage","children":[0===z.length?re:null,Object(y.jsxs)(x.q,{"className":"videoContainer","children":[Object(y.jsx)(f.a,{"pictureArray":T,"videoArray":z,"sid":B}),0===z.length?ne:Object(y.jsxs)(x.q,{"className":"floatArea","style":{"bottom":"".concat(55,"px")},"children":[se,ie]})]}),0===z.length?oe:le,ue]})};t.default=g}}]);